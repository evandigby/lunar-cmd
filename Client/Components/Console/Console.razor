@using System.Security.Claims
@using Data.Commands
@using System.Threading
@inject HttpClient http

<Stack VerticalFill VerticalAlign="Alignment.End">
    <Stack VerticalFill VerticalAlign="Alignment.End" Style="border: 1px solid red;">

    </Stack>
    <form @onsubmit=Enter>
        <Stack Style="border: 1px solid blue;" Horizontal>
            <StackItem Grow=1>
                <TextField @bind-Value=currentValue />
            </StackItem>
            <DefaultButton Text="Send" />
        </Stack>
    </form>
</Stack>

@code {
    private string currentValue = "";

    private async Task Enter()
    {
        var cmd = new AppendLogItemCommand(Guid.NewGuid(), new PlaintextPayloadValue
            {
                Value = currentValue
            });

        var src = new CancellationTokenSource();
        await http.PostAsJsonAsync("/api/command", cmd, src.Token);
        currentValue = "";
    }
}
